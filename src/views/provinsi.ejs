<!DOCTYPE html>
<html lang="en">
<head>
    <!-- <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <title>Provinsi Data</title>
</head>
<body>
    <h1>Provinsi Data</h1>
    <button id="btnBack">Back to Wilayah</button>
    <button id="btnLogout">Logout</button>

    <pre id="data"></pre>

    <script>
        const dataPre = document.getElementById('data');
        const btnBack = document.getElementById('btnBack');
        const btnLogout = document.getElementById('btnLogout');

        btnBack.onclick = () => {
            window.location.href = '/wilayah';
        };

        btnLogout.onclick = () => {
            localStorage.removeItem('token');
            window.location.href = '/login';
        };

        async function fetchProvinsi() {
            const token = localStorage.getItem('token');
            if(!token) {
                window.location.href = '/login';
                return;
            }

            try {
                const response = await fetch('/api/wilayah/provinsi', {
                    headers: { Authorization: `Bearer ` + token }
                });

                if(response.status ===401 || response.status === 403) {
                    localStorage.removeItem('token');
                    window.location.href = '/login';
                    return;
                }

                const json = await response.json();
                if(json.status) {
                    dataPre.textContent = JSON.stringify(data.data, null, 2);
                } else {
                    dataPre.textContent = data.message || 'Failed to fetch data';
                }
            } catch (error) {
                dataPre.textContent = 'An error occurred. Please try again.' + error.message;
            }
        }

        fetchProvinsi();
    </script>
    
</body>
</html>